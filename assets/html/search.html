<div ng-controller="searchController" id="search">
    <form class="form-horizontal" role="form">
        <div style="width:100%;clear: both">
            <div class="form-group col-xs-11">
                <div >
                    <input ng-model="phrase" type="text" class="form-control" ng-change="addPhrase()"
                           id="searchTerm" placeholder="Введіть назву документу">
                </div>
            </div>
            <div class="form-group col-xs-1" style="float: right">
                <div >
                    <button type="submit" class="btn btn-primary" ng-click="doSearch()">Пошук</button>
                </div>
            </div>
        </div>
        <div style="width:100%;clear: both" class="search_params form-group">
            <div class="col-xs-1">
                Фільтри:
            </div>
            <div class="col-xs-3">
                <input type="text"
                       ng-model="govern"
                       placeholder="Орган влади"
                       uib-typeahead="gov as gov.name for gov in governs | filter:$viewValue | limitTo:15"
                       class="form-control"
                       typeahead-on-select="addTerm('govern', $item.id)"
                       typeahead-min-length="0"
                       typeahead-focus-on-select="true"
                       typeahead-editable="false">
            </div>
            <div class="col-xs-3">
                <input type="text"
                       ng-model="region"
                       placeholder="Регіон"
                       uib-typeahead="region as region.name for region in regions | filter:$viewValue | limitTo:15"
                       class="form-control"
                       typeahead-on-select="addTerm('region', $item.id)"
                       typeahead-min-length="0"
                       typeahead-focus-on-select="true"
                       typeahead-editable="false">
            </div>
            <div class="col-xs-3">
                <input type="text"
                       ng-model="business"
                       placeholder="Вид бізнесу"
                       uib-typeahead="business as business.name for business in businesses | filter:$viewValue | limitTo:15"
                       class="form-control"
                       typeahead-on-select="addTerm('business', $item.id)"
                       typeahead-min-length="0"
                       typeahead-focus-on-select="true"
                       typeahead-editable="false">
            </div>
        </div>
    </form>
    <div ng-show="results" ng-include="'results.html'"></div>
</div>




<script type="text/ng-template" id="results.html" >
    <h3 class="col-md-12 clearfix">Результати пошуку:</h3>
    <div style="padding: 3px 0px;clear: both;border:1px solid cornflowerblue;border-radius: 4px;display: block;" class="col-md-12">
        <div class="col-md-2 alert alert-success" style="margin-bottom: 0px;height: 11px;line-height: 0px;padding: 14px;">
            Сортувати:
        </div>
        <div class="col-md-4">
            <button ng-click="sortBy('corr_result')" class="btn btn-primary btn-sm btn-block floatleft">Кілкість кор. складових</button>
            <span class="sortorder floatleft" style="margin-left: -17px;" ng-show="propertyName === 'corr_result'" ng-class="{reverse: reverse}"></span>
        </div>
        <div class="col-md-4">
            <button ng-click="sortBy('math_result')" class=" btn btn-primary btn-sm btn-block floatleft">Результат розрахункыв</button>
            <span class="sortorder floatleft" style="margin-left: -17px;" ng-show="propertyName === 'math_result'" ng-class="{reverse: reverse}"></span>
        </div>
    </div>
    <ul style="list-style: none;    padding-left: 0px;">
        <li ng-repeat="hit in results.hits.hits|orderBy:propertyName:reverse">
            <div class="well col-md-12">
                <div class="pull-left col-xs-12">
                    <span class="pull-left" >Назва:	&nbsp;</span>
                    <a href="/track/{[{ hit._source.mid }]}" target="_blank" class="clearfix"> {[{ hit._source.name }]}</a>
                </div>
                <div class="pull-left col-xs-6">Орган влади: {[{ governs[hit._source.govern - 1].name }]}</div>
                <div class="pull-left col-xs-6">Вид бізнесу: {[{ getBusinessNames(hit._source.business) }]}</div>
                <div class="pull-left col-xs-6">Регіон: {[{ regions[hit._source.region - 1].name }]}</div>
                <div class="pull-left col-xs-6">Розробник: {[{ hit._source.author }]}</div>
                <div class="pull-left col-xs-6">Кілкість критичних кор. складових: {[{ hit._source.corr_result }]}</div>
                <div class="pull-left col-xs-6">Результат розрахунків: {[{ hit._source.math_result }]}</div>
            </div>

        </li>
    </ul>

    <div class="col-xs-12 search-pgn">
        <ul uib-pagination total-items="results.hits.total"
            max-size="10"
            ng-model="currentPage"
            boundary-links="true"
            force-ellipses="true"
            rotate="true"
            first-text="Перша"
            last-text="Остання"
            next-text="Вперед"
            previous-text="Назад"
            ng-change="query.from=currentPage*10;doSearch()"></ul>
    </div>
</script>